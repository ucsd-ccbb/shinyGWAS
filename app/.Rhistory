IRkernel::installspec()
q()
1000/7000
gene_names <- c("A1BG|1", "A1CF|29974")
gsub("|.*", "", gene_names)
gsub("*|.*", "", gene_names)
gsub("|*", "", gene_names)
gsub("\\|*", "", gene_names)
gsub("\\|.*", "", gene_names)
markers <- c("Itga2b",
"Selp",
"Gp1ba",
"Gp5",
"Gp1bb",
"Ly6g6f",
"Trpc6",
"Dgkg",
"Rab27b",
"P2ry1",
"Mpig6b",
"F5",
"Gp9",
"Orm1",
"Itgb3",
"Pf4",
"Vwf",
"Thbs1",
"F2rl2",
"Ppbp",
"F10",
"Plek2",
"Tuba8",
"Tubb1",
"Gp6",
"P2rx1",
"Ache",
"Gfi1b",
"Nfe2",
"Aqp1",
"Vcl",
"Sytl4",
"Clec1b",
"Pde5a",
"Mrvi1")
load("/Users/artnasamran/CCBB_projects/20191021_cooke_rnaseq/notebooks/20191021_v_table_spleen.rda")
k <- which(v$genes$SYMBOL %in% markers)
my_group = as.factor(v$targets$Condition)
head(v$targets)
my_group = as.factor(v$targets$exp_group)
my_col = brewer.pal(5, "Set2")[my_group]
library(gplots)
library(RColorBrewer)
my_col = brewer.pal(5, "Set2")[my_group]
mycol <- colorpanel(1000,"blue","white","red")
contrast_list = c('FVIII_Saline_day3 - Baseline', 'BALBc_day3 - Uninjured', 'rhFVIII_day3 - Uninjured', 'rhFVIII_mFc_day3 - Uninjured')
for (i in contrast_list){
heatmap.2(v$E[k,include_idx],
scale="row",
labRow = v$genes$SYMBOL[k],
labCol=FALSE,
legend = unique(my_group),
margins = c(5, 15),
col=mycol,
trace="none",
density.info="none",
ColSideColors=my_col,
key=T,
lhei = c(1.1, 4),
lwid = c(1.6, 4),
dendrogram="column",
main = "Platelet activation")
legend("topleft",
fill = unique(my_col),
cex = .75,
legend = unique(my_group),
inset=c(0,.15))
}
for (i in contrast_list){
heatmap.2(v$E[k,],
scale="row",
labRow = v$genes$SYMBOL[k],
labCol=FALSE,
legend = unique(my_group),
margins = c(5, 15),
col=mycol,
trace="none",
density.info="none",
ColSideColors=my_col,
key=T,
lhei = c(1.1, 4),
lwid = c(1.6, 4),
dendrogram="column",
main = "Platelet activation")
legend("topleft",
fill = unique(my_col),
cex = .75,
legend = unique(my_group),
inset=c(0,.15))
}
my_group = as.factor(v$targets$exp_group)
my_col = brewer.pal(11, "Set2")[my_group]
mycol <- colorpanel(1000,"blue","white","red")
contrast_list = c('FVIII_Saline_day3 - Baseline', 'BALBc_day3 - Uninjured', 'rhFVIII_day3 - Uninjured', 'rhFVIII_mFc_day3 - Uninjured')
for (i in contrast_list){
heatmap.2(v$E[k,include_idx],
scale="row",
labRow = v$genes$SYMBOL[k],
labCol=FALSE,
legend = unique(my_group),
margins = c(5, 15),
col=mycol,
trace="none",
density.info="none",
ColSideColors=my_col,
key=T,
lhei = c(1.1, 4),
lwid = c(1.6, 4),
dendrogram="column",
main = "Platelet activation")
legend("topleft",
fill = unique(my_col),
cex = .75,
legend = unique(my_group),
inset=c(0,.15))
}
for (i in contrast_list){
heatmap.2(v$E[k,],
scale="row",
labRow = v$genes$SYMBOL[k],
labCol=FALSE,
legend = unique(my_group),
margins = c(5, 15),
col=mycol,
trace="none",
density.info="none",
ColSideColors=my_col,
key=T,
lhei = c(1.1, 4),
lwid = c(1.6, 4),
dendrogram="column",
main = "Platelet activation")
legend("topleft",
fill = unique(my_col),
cex = .75,
legend = unique(my_group),
inset=c(0,.15))
}
unique(v$targets$group)
length(unique(v$targets(group)))
length(unique(v$targets$group))
length(unique(v$targets$exp_group))
markers <- c("Itga2b",
"Selp",
"Gp1ba",
"Gp5",
"Gp1bb",
"Ly6g6f",
"Trpc6",
"Dgkg",
"Rab27b",
"P2ry1",
"Mpig6b",
"F5",
"Gp9",
"Orm1",
"Itgb3",
"Pf4",
"Vwf",
"Thbs1",
"F2rl2",
"Ppbp",
"F10",
"Plek2",
"Tuba8",
"Tubb1",
"Gp6",
"P2rx1",
"Ache",
"Gfi1b",
"Nfe2",
"Aqp1",
"Vcl",
"Sytl4",
"Clec1b",
"Pde5a",
"Mrvi1")
load("/Users/artnasamran/CCBB_projects/20191021_cooke_rnaseq/notebooks/20191021_v_table_spleen.rda")
k <- which(v$genes$SYMBOL %in% markers)
unique(v$targets$group)
unique(v$targets$exp_group)
groups_to_keep <- c("B_Saline_3d", "B_Saline_2w")
include_idx <- which(v$targets$exp_group %in% groups_to_keep)
my_group = as.factor(v$targets$exp_group)[include_idx]
my_col = brewer.pal((length(unique(my_group))), "Set2")[my_group]
library(gplots)
library(RColorBrewer)
my_group = as.factor(v$targets$exp_group)[include_idx]
my_col = brewer.pal((length(unique(my_group))), "Set2")[my_group]
mycol <- colorpanel(1000,"blue","white","red")
heatmap.2(v$E[k,include_idx],
scale="row",
labRow = v$genes$SYMBOL[k],
labCol=FALSE,
legend = unique(my_group),
margins = c(5, 15),
col=mycol,
trace="none",
density.info="none",
ColSideColors=my_col,
key=T,
lhei = c(1.1, 4),
lwid = c(1.6, 4),
dendrogram="column",
main = "Platelet activation")
legend("topleft",
fill = unique(my_col),
cex = .75,
legend = unique(my_group),
inset=c(0,.15))
heatmap.2(v$E[k,include_idx],
scale="row",
labRow = v$genes$SYMBOL[k],
labCol=v$targets$Sample_Name[include_idx],
legend = unique(my_group),
margins = c(5, 15),
col=mycol,
trace="none",
density.info="none",
ColSideColors=my_col,
key=T,
lhei = c(1.1, 4),
lwid = c(1.6, 4),
dendrogram="column",
main = "Platelet activation")
legend("topleft",
fill = unique(my_col),
cex = .75,
legend = unique(my_group),
inset=c(0,.15))
unique(v$targets$exp_group)
rosmap <- read.csv("/Users/artnasamran/CCBB_projects/20191024_Edland_ROSMAP/dataset_814_basic_11-20-2019.csv")
fam <- read.csv("/Users/artnasamran/Downloads/ROSMAP_arrayGenotype.fam")
fam <- read.csv("/Users/artnasamran/Downloads/ROSMAP_arrayGenotype.fam", sep = "\t")
fam <- read.csv("/Users/artnasamran/Downloads/ROSMAP_arrayGenotype.fam", sep = " ")
rosmap$fam <- paste0(rosmap$study, rosmap$projid)
fam <- read.csv("/Users/artnasamran/Downloads/ROSMAP_arrayGenotype.fam", sep = " ", header = FALSE)
which(fam$V2 %in% rosmap$fam)
rosmap$fam <- paste0(rosmap$study, rosmap$projid)
which(fam$V2 %in% rosmap$fam)
View(rosmap)
rosmap$fam <- paste0(rosmap$study, rosmap$projid)
rosmap$fam <- gsub(" ", "", rosmap$fam)
which(fam$V2 %in% rosmap$fam)
which(rosmap$fam %in% fam$V2)
subset <- rosmap[which(rosmap$fam %in% fam$V2),]
getwd()
write.table(subset, file = "ROSMAP_GWAS_Metadata.csv", quote = FALSE, row.names = FALSE)
write.csv(subset, file = "ROSMAP_GWAS_Metadata.csv", quote = FALSE, row.names = FALSE)
table(subset$braaksc)
length(which(is.na(subset$braaksc)))
gwas_rosmap <- read.csv("/Users/artnasamran/CCBB_projects/20200602_edland_rosmap/ROSMAP_assay_snpArray_metadata_projids.csv", header = TRUE)
View(gwas_rosmap)
gwas_rosmap <- read.csv("/Users/artnasamran/CCBB_projects/20200602_edland_rosmap/ROSMAP_assay_snpArray_metadata_projids.csv", header = TRUE)
wgs_rosmap <- read.csv("/Users/artnasamran/CCBB_projects/20191024_Edland_ROSMAP/AMP-AD_rosmap_WGS_id_key.csv", header = TRUE)
metadata <- read.csv("/Users/artnasamran/CCBB_projects/20191024_Edland_ROSMAP/dataset_814_basic_11-20-2019.csv", header = TRUE)
View(metadata)
table(metadata$dlbdx)
gwas.idx <- match(gwas_rosmap$Projid, metadata$projid)
wgs.idx <- match(wgs_rosmap$projid, metadata$projid)
gwas_rosmap$dlbdx <- metadata$dlbdx[gwas.idx]
wgs_rosmap$dlbdx <- metadata$dlbdx[wgs.idx]
View(gwas_rosmap)
length(which(is.na(gwas_rosmap$dlbdx)))
table(gwas_rosmap$dlbdx)
View(wgs_rosmap)
length(which(is.na(wgs_rosmap$dlbdx)))
table(wgs_rosmap$dlbdx)
insert_sizes <- read.csv("/Users/artnasamran/CCBB_projects/20210211_covid_qc/ARTIC_results/qualimap/002idSEARCH-5329-SAN_L001_L002_L003_L004.sorted.stats/raw_data_qualimapReport/insert_size_across_reference.txt")
View(insert_sizes)
insert_sizes <- read.csv("/Users/artnasamran/CCBB_projects/20210211_covid_qc/ARTIC_results/qualimap/002idSEARCH-5329-SAN_L001_L002_L003_L004.sorted.stats/raw_data_qualimapReport/insert_size_across_reference.txt", header = F)
insert_sizes <- read.table("/Users/artnasamran/CCBB_projects/20210211_covid_qc/ARTIC_results/qualimap/002idSEARCH-5329-SAN_L001_L002_L003_L004.sorted.stats/raw_data_qualimapReport/insert_size_across_reference.txt", header = F)
head(insert_sizes)
summary(insert_sizes$V2)
meta <- read.table("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/filereport_read_run_PRJNA641129_tsv.txt")
View(meta)
names <- read.csv("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/inputs/GSE152991_series_matrix_formatted.csv")
View(names)
names <- as.data.frame(t(names))
View(names)
names$V39
View(meta)
names$V8
View(names)
names$V39
names <- read.csv("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/inputs/GSE152991_series_matrix_formatted.csv")
names <- as.data.frame(t(names))
colnames(names) <- gsub("!", "", names[1,])
names <- names[-1,]
View(names)
names <- read.csv("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/inputs/GSE152991_series_matrix_formatted.csv")
View(names)
names <- as.data.frame(t(names))
View(names)
View(names)
names <- names[,c(V7, V8, V39)]
names <- names[,c("V7", "V8", "V39")]
View(names)
head(names$V39)
names$V39 <- gsub("SRA: https://www.ncbi.nlm.nih.gov/sra?term=", "", names$V39)
names$V7 <- gsub("_Subcutaneous adipose tissue", "", names$V7)
View(names)
names$V39 <- gsub("SRA: https:\/\/www.ncbi.nlm.nih.gov\/sra?term=", "", names$V39)
meta <- read.table("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/filereport_read_run_PRJNA641129_tsv.txt", stringsAsFactors = F)
names <- read.csv("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/inputs/GSE152991_series_matrix_formatted.csv", stringsAsFactors = F)
names <- as.data.frame(t(names))
names <- names[,c("V7", "V8", "V39")]
names$V39 <- gsub("SRA: https://www.ncbi.nlm.nih.gov/sra?term=", "", names$V39)
names$V7 <- gsub("_Subcutaneous adipose tissue", "", names$V7)
View(names)
names$V39 <- gsub("SRA: https:\\/\\/www\\.ncbi\\.nlm\\.nih\\.gov\\/sra?term=", "", names$V39)
View(names)
names <- names[-1,]
View(names)
View(names)
View(names)
colnames(names) <- c("Condition", "Species", "AltID")
write.table(names, "/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/metadata.txt")
write.table(names, "/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/metadata.txt", quote = F)
View(meta)
names <- read.table("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/metadata.txt")
names <- read.table("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/metadata.txt")
#names <- names[,c("V7", "V8", "V39")]
#names$V39 <- gsub("SRA: https://www.ncbi.nlm.nih.gov/sra?term=", "", names$V39)
#names$V7 <- gsub("_Subcutaneous adipose tissue", "", names$V7)
#names <- names[-1,]
#colnames(names) <- c("Condition", "Species", "AltID")
write.csv(names, "/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/metadata.txt", quote = F)
names <- read.csv("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/metadata.txt")
View(names)
match(names$AltID, meta$V3)
comb <- meta[, c("V3", "V4")]
View(comb)
colnames(comb) <- comb[1,]
comb <- comb[-1,]
View(comb)
View(names)
match(names$AltID, comb$experiment_accession)
match(comb$experiment_accession, names$AltID)
comb$Sample_Name <- names$Sample[idx]
idx <- match(comb$experiment_accession, names$AltID)
comb$Sample_Name <- names$Sample[idx]
View(comb)
seq(1:len(comb$Sample_Name), 2)
seq(1:length(comb$Sample_Name), 2)
seq(1, length(comb$Sample_Name), 2)
seq(2, length(comb$Sample_Name), 2)
comb$Sample_Name[seq(1, length(comb$Sample_Name), 2)] <- paste(comb$Sample_Name[seq(1, length(comb$Sample_Name), 2)], "R1.fastq.gz", sep = "_")
comb$Sample_Name[seq(2, length(comb$Sample_Name), 2)] <- paste(comb$Sample_Name[seq(2, length(comb$Sample_Name), 2)], "R2.fastq.gz", sep = "_")
comb$Sample_Name[seq(1, length(comb$Sample_Name), 2)]
names <- read.csv("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/metadata.txt", stringsAsFactors = F)
match(names$AltID, meta$V3)
comb <- meta[, c("V3", "V4")]
colnames(comb) <- comb[1,]
comb <- comb[-1,]
idx <- match(comb$experiment_accession, names$AltID)
comb$Sample_Name <- names$Sample[idx]
comb$Sample_Name[seq(1, length(comb$Sample_Name), 2)] <- paste(comb$Sample_Name[seq(1, length(comb$Sample_Name), 2)], "R1.fastq.gz", sep = "_")
comb$Sample_Name[seq(2, length(comb$Sample_Name), 2)] <- paste(comb$Sample_Name[seq(2, length(comb$Sample_Name), 2)], "R2.fastq.gz", sep = "_")
View(comb)
names <- read.csv("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/metadata.txt", stringsAsFactors = F)
match(names$AltID, meta$V3)
comb <- meta[, c("V3", "V4")]
colnames(comb) <- comb[1,]
comb <- comb[-1,]
idx <- match(comb$experiment_accession, names$AltID)
comb$Sample_Name <- names$Sample[idx]
comb$File_Name[seq(1, length(comb$Sample_Name), 2)] <- paste(comb$Sample_Name[seq(1, length(comb$Sample_Name), 2)], "R1.fastq.gz", sep = "_")
names <- read.csv("/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/metadata.txt", stringsAsFactors = F)
match(names$AltID, meta$V3)
comb <- meta[, c("V3", "V4")]
colnames(comb) <- comb[1,]
comb <- comb[-1,]
idx <- match(comb$experiment_accession, names$AltID)
comb$Sample_Name <- names$Sample[idx]
comb$Sample_Name[seq(1, length(comb$Sample_Name), 2)] <- paste(comb$Sample_Name[seq(1, length(comb$Sample_Name), 2)], "R1.fastq.gz", sep = "_")
comb$Sample_Name[seq(2, length(comb$Sample_Name), 2)] <- paste(comb$Sample_Name[seq(2, length(comb$Sample_Name), 2)], "R2.fastq.gz", sep = "_")
View(comb)
write.csv(comb, file = "/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/translated_filenames.csv", quote = FALSE)
write.csv(comb, file = "/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/translated_filenames.csv", quote = FALSE, row.names = FALSE)
comb$run_accession <- paste0(comb$run_accession, ".fastq.gz")
View(comb)
write.csv(comb, file = "/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/translated_filenames.csv", quote = FALSE, row.names = FALSE)
write.csv(comb[,c(2,3)], file = "/Users/artnasamran/CCBB_projects/20210224_lee_rnaseq_geo/translated_filenames2.csv", quote = FALSE, row.names = FALSE)
View(names)
glm()
?glm
shiny::runApp('CCBB_projects/ScrnaseqShinyApp/test_scrnaseq_app')
runApp('CCBB_projects/ScrnaseqShinyApp/test_scrnaseq_app')
?selectInput
runApp('CCBB_projects/ScrnaseqShinyApp/test_scrnaseq_app')
runApp('CCBB_projects/ScrnaseqShinyApp/test_scrnaseq_app')
read.csv.possiblyCompressed = function(fileName, ...){
n = nchar(fileName)
if (substring(fileName, n-3, n)==".zip") {data = read.zip(fileName) } else if (substring(fileName, n-2, n)==".gz") {data = read.csv.sql(file = as.data.frame(gzfile(fileName, ...)))} else if (substring(fileName, n-3, n)==".bz2") {data = read.csv.sql(file = as.data.frame(bzfile(fileName, ...))) } else { data = read.csv.sql(file = fileName, ...) }
data
}
read.csv.possiblyCompressed("/Users/artnasamran/CCBB_projects/20210821_desplats_pdd_pds/Horvath_methylation_age_files/20210929_PPMI_CIvsCN_bvals_methage.csv")
data <- read.csv("/Users/artnasamran/CCBB_projects/20210821_desplats_pdd_pds/Horvath_methylation_age_files/20210929_PPMI_CIvsCN_bvals_methage.csv")
dat0[1:5,1:5]
data[1:5,1:5]
reticulate::virtualenv_create("python_env", python = "python3")
help(reticulate::virtualenv_create())
reticulate::virtualenv_create("python_env")
shiny::runApp('CCBB_projects/20220516_nakagawa_scrnaseq/shiny_app')
shiny::runApp('CCBB_projects/20220516_nakagawa_scrnaseq/shiny_app')
runApp('CCBB_projects/20220516_nakagawa_scrnaseq/shiny_app_small')
runApp('CCBB_projects/20220516_nakagawa_scrnaseq/shiny_app')
shiny::runApp('CCBB_projects/20220516_nakagawa_scrnaseq/shiny_app')
library(rsconnect)
rsconnect::setAccountInfo(name='ucsdccbb',
token='136C7CD12693C573FB7E0E59C3DCA39B',
secret='yu4WMCcr5sSqAgCqiC9zEaTg+uNC96apBdbdrRp8')
options(rsconnect.max.bundle.size = 5000000000)
shiny::runApp('CCBB_projects/20220516_nakagawa_scrnaseq/shiny_app')
runApp('CCBB_projects/20220113_yan_scrnaseq/shiny_app/scrnaseq_shiny_app')
?VlnPlot
`20220520_nakagawa_shiny_cluster_markers` <- readRDS("/Users/artnasamran/CCBB_projects/20220516_nakagawa_scrnaseq/shiny_app/20220520_nakagawa_shiny_cluster_markers.rds")
top5 <- `20220520_nakagawa_shiny_cluster_markers` %>% group_by(cluster) %>% top_n(n = 5, wt = avg_diff)
library(dplyr)
top5 <- `20220520_nakagawa_shiny_cluster_markers` %>% group_by(cluster) %>% top_n(n = 5, wt = avg_diff)
library(Seurat)
shiny::runApp('CCBB_projects/20220516_nakagawa_scrnaseq/shiny_app')
runApp('CCBB_projects/20220516_nakagawa_scrnaseq/shiny_app_annot')
runApp('CCBB_projects/20220516_nakagawa_scrnaseq/shiny_app')
shiny::runApp('Documents/shinyGWAS/app')
shiny::runApp('Documents/shinyGWAS/app')
sessionInfo()
capture.output(sessionInfo())
print(sessionInfo())
tmp <- print(sessionInfo())
tmp
runApp('Documents/shinyGWAS/app')
tmp
tmp <- capture.output(sessionInfo())
tmp[1]
tmp[2]
tmp <- paste0(tmp, "\n")
tmp
runApp('Documents/shinyGWAS/app')
